# TODO: Задачи для завершения проекта BTC Betting

## ✅ Реализовано

1. **Динамические периоды для тестирования**

   - Добавлена возможность изменять периоды ставок и задержки результатов
   - Реализованы скрипты для управления периодами
   - Минимальные значения для периодов: 5 минут для ставок, 1 минута для задержки результатов

2. **Мок-оракул для тестирования**

   - Реализован мок-оракул Chainlink для BTC/USD на Polygon Amoy
   - Добавлены скрипты для деплоя и обновления мок-оракула
   - Интеграция с основным контрактом

3. **Автоматизация определения победителей**
   - Реализованы скрипты для автоматического определения победителей
   - Настройка cron-задачи для запуска в нужное время

## Автоматизация определения победителей

Функция `determineWinnersAndStartNewRound()` в контракте BTCBettingPolygon должна вызываться вручную владельцем контракта (`onlyOwner`). Для полной автоматизации процесса необходимо настроить внешний сервис, который будет вызывать эту функцию каждый день в нужное время.

### Варианты реализации автоматизации:

1. **Chainlink Automation (бывший Keeper)**

   - Настроить Chainlink Automation для автоматического вызова функции `determineWinnersAndStartNewRound()`
   - Документация: https://docs.chain.link/chainlink-automation/introduction
   - Шаги:
     - Зарегистрировать контракт в Chainlink Automation Registry
     - Реализовать интерфейс AutomationCompatibleInterface
     - Пополнить баланс LINK для оплаты автоматизации

2. **Cron-задача на сервере**
   - ✅ Настроить cron-задачу на сервере, которая будет вызывать функцию `determineWinnersAndStartNewRound()`
   - Потребуется:
     - Приватный ключ владельца контракта (хранить безопасно!)
     - Скрипт для вызова функции (например, на Node.js с ethers.js)
     - Настройка cron-задачи для запуска в нужное время

## Дополнительные улучшения

1. **Мониторинг и оповещения**

   - Настроить мониторинг для отслеживания успешного вызова функции определения победителей
   - Настроить оповещения в случае сбоев

2. **Резервный механизм**

   - Реализовать резервный механизм на случай, если автоматический вызов не сработает
   - Например, добавить возможность вызова функции любым пользователем после определенного времени

3. **Тестирование на Polygon Amoy**

   - ✅ Провести полное тестирование контракта на тестовой сети Polygon Amoy
   - ✅ Реализовать мок-оракул для тестирования на Polygon Amoy
   - ✅ Добавить динамические периоды для упрощения тестирования

4. **Аудит безопасности**

   - Провести аудит безопасности контракта перед деплоем на Polygon Mainnet
   - Особое внимание уделить логике определения победителей и распределения призов

5. **Фронтенд-интерфейс**
   - Разработать удобный пользовательский интерфейс для взаимодействия с контрактом
   - Отображать информацию о текущем раунде, времени до окончания ставок, истории ставок и т.д.

## Миграция на Polygon Mainnet

1. **Обновление адресов Price Feed**

   - Обновить адрес Chainlink Price Feed для BTC/USD на Ethereum Mainnet
   - Убедиться, что контракт корректно получает данные о цене

2. **Настройка параметров**

   - Пересмотреть параметры контракта (комиссия, минимальная ставка и т.д.) для Mainnet
   - Обновить временные параметры, если необходимо

3. **Деплой и верификация**
   - Деплоить контракт на Polygon Mainnet
   - Верифицировать контракт на Polygonscan

## Новые задачи

1. **Оптимизация газа**

   - Провести анализ потребления газа функциями контракта
   - Оптимизировать функции для снижения затрат на газ

2. **Улучшение документации**

   - Дополнить документацию примерами использования
   - Создать руководство для пользователей

3. **Интеграция с другими сервисами**
   - Исследовать возможности интеграции с другими DeFi-протоколами
   - Рассмотреть возможность использования других оракулов для резервного копирования данных
